<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Guzzle Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Guzzle Blog Atom Feed"><title data-react-helmet="true">Deployment structure changes (Guzzle 2.3.0) | Guzzle</title><meta data-react-helmet="true" property="og:url" content="https://guzzle.justanalytics.com/docs/releases/2_3_0/deployment-structure-changes"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Deployment structure changes (Guzzle 2.3.0) | Guzzle"><meta data-react-helmet="true" name="description" content="As per new deployment approach, guzzle reduces scope of shared storage just to keep guzzle module and third-party dependency jar files which can be referenced by activities running in the remote clusters. Guzzle API must be accessible from the remote clusters where guzzle activities are running. Following are the high-level changes -"><meta data-react-helmet="true" property="og:description" content="As per new deployment approach, guzzle reduces scope of shared storage just to keep guzzle module and third-party dependency jar files which can be referenced by activities running in the remote clusters. Guzzle API must be accessible from the remote clusters where guzzle activities are running. Following are the high-level changes -"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://guzzle.justanalytics.com/docs/releases/2_3_0/deployment-structure-changes"><link data-react-helmet="true" rel="alternate" href="https://guzzle.justanalytics.com/docs/releases/2_3_0/deployment-structure-changes" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://guzzle.justanalytics.com/docs/releases/2_3_0/deployment-structure-changes" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.a9a821e7.css">
<link rel="preload" href="/assets/js/runtime~main.6ef0d48b.js" as="script">
<link rel="preload" href="/assets/js/main.b56963d5.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/guzzle-logo.svg" alt="Guzzle" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/guzzle-logo.svg" alt="Guzzle" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title"></strong></a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a class="navbar__item navbar__link" href="/api/api">API</a><a class="navbar__item navbar__link" href="/docs/changelog">Changelog</a></div><div class="navbar__items navbar__items--right"><div class="searchWrapper_3rmH"></div><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/guzzle-logo.svg" alt="Guzzle" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/guzzle-logo.svg" alt="Guzzle" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/api/api">API</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/changelog">Changelog</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><main class="docMainContainer_3ufF docMainContainerEnhanced_3NYZ"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Deployment structure changes (Guzzle 2.3.0)</h1></header><div class="markdown"><p>As per new deployment approach, guzzle reduces scope of shared storage just to keep guzzle module and third-party dependency jar files which can be referenced by activities running in the remote clusters. Guzzle API must be accessible from the remote clusters where guzzle activities are running. Following are the high-level changes -</p><ul><li>Shared storage account is not needed to be mounted on Guzzle VM or remote spark clusters</li><li>Guzzle keeps all configs and logs on local file system of the Guzzle VM. Activities running in remote spark clusters use Guzzle APIs to read necessary configs and to write activity logs</li><li><strong>GUZZLE_HOME</strong> environment variable is not needed to be defined in Guzzle VM. All the directories from previous <strong>GUZZLE_HOME</strong> are now referred from <strong>GUZZLE_PRODUCT_HOME</strong></li><li>Guzzle config file <strong>guzzle.yml</strong> is removed. All the config properties from <strong>guzzle.yml</strong> are referred from <strong>guzzle-api.yml</strong></li><li>When shared storage is enabled - guzzle upgrade process will sync guzzle module and third-party dependency jar files every time guzzle is upgraded. Also there is an option to sync jar files with storage account in Guzzle UI</li><li>Setup Workspace button from databricks compute editor is removed</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="automatic-upgrade-steps"></a>Automatic upgrade steps<a class="hash-link" href="#automatic-upgrade-steps" title="Direct link to heading">#</a></h3><ul><li>Move directories bin, conf, libs, logs, scripts and test-data from current <strong>GUZZLE_HOME</strong> to <strong>GUZZLE_PRODUCT_HOME</strong></li><li>Remove version.txt file from current <strong>GUZZLE_HOME</strong></li><li>Move config properties default_spark, java, guzzle and api from <strong>guzzle.yml</strong> to <strong>guzzle-api.yml</strong></li><li>Remove guzzle.yml and passphrase files from conf directory</li><li>Remove config property <strong>dbfs_guzzle_dir</strong> from azure databricks compute configs</li><li>Remove config property <strong>guzzle_storage_linked_service</strong> from azure synapse spark compute configs</li><li>Remove <strong>mount</strong> properties of <strong>storage</strong> setting specified in <strong>guzzle-api.yml</strong></li><li>Add property <code>deployment_scheme: azure</code> under <strong>guzzle</strong> setting in <strong>guzzle-api.yml</strong></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="post-upgrade-manual-setup-steps"></a>Post upgrade manual setup steps<a class="hash-link" href="#post-upgrade-manual-setup-steps" title="Direct link to heading">#</a></h3><ul><li>Ensure that Guzzle API is accessible from the remote spark cluster</li><li>Navigate to <strong>Manage &gt; Environment Config &gt; Api Settings</strong> in Guzzle UI and specify Guzzle API URL, Key vault name and Secret name which is holding value of the passphrase</li><li>Unmount guzzle shared storage account from Guzzle VM <strong>[Optional]</strong></li><li>Remove <strong>GUZZLE_HOME</strong> environment variable from guzzle service (/lib/systemd/system/guzzle.service) <strong>[Optional]</strong></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="when-using-azure-databricks-clusters--"></a>When using Azure databricks clusters -<a class="hash-link" href="#when-using-azure-databricks-clusters--" title="Direct link to heading">#</a></h4><ul><li>In databricks analytics clusters - specify following spark config which will be used as credential to refer and install jars from the shared storage (secret value should be access key of the storage account) -<br><code>fs.azure.account.key.[storage-account-name].dfs.core.windows.net {{secrets/[secret-scope]/[secret-name]}}</code></li><li>Unmount guzzle shared storage account from databricks workspace <strong>[Optional]</strong></li><li><strong>GUZZLE_HOME</strong> environment variable is not needed for databricks analytics clusters and can be removed <strong>[Optional]</strong></li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="when-using-azure-synapse-spark-clusters--"></a>When using Azure synapse spark clusters -<a class="hash-link" href="#when-using-azure-synapse-spark-clusters--" title="Direct link to heading">#</a></h4><ul><li>Linked service for guzzle shared storage can be removed from synapse workspace <strong>[Optional]</strong></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/ja-guzzle/docs/blob/master/docs/releases/2_3_0/deployment-structure-changes.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#automatic-upgrade-steps" class="table-of-contents__link">Automatic upgrade steps</a></li><li><a href="#post-upgrade-manual-setup-steps" class="table-of-contents__link">Post upgrade manual setup steps</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2023 Just Analytics, Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.6ef0d48b.js"></script>
<script src="/assets/js/main.b56963d5.js"></script>
</body>
</html>